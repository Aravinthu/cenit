require 'json'
require 'openssl'
require 'httparty.rb'

conn = Bunny.new
conn.start
ch   = conn.create_channel
q    = ch.queue('send.to.website')

puts " [*] Waiting for messages in #{q.name}. To exit press CTRL+C"
q.subscribe(:block => true) do |delivery_info, properties, body|
  puts " [x] Received #{body}"

  #HTTParty.post(message[:path],
  #	  {
  #		body: message[:object].to_json,
  #		headers: {
  #		 'Content-Type'       => 'application/json',
  #		 'X-Hub-Store'        => '123',
  #		 'X-Hub-Access-Token' => '456',
  #		 'X-Hub-Timestamp'    => Time.now.utc.to_i.to_s
  #		}
  #	  }
  #	)

  delivery_info.consumer.cancel
end
